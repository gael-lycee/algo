<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Visionneuse de fichiers</title>
  <style>
    body { font-family: monospace; background: #1e1e1e; color: #d4d4d4; padding: 20px; }
    pre { background: #252526; padding: 15px; border-radius: 8px; overflow-x: auto; }
    a { color: #4fc3f7; }
  </style>
</head>
<body>
  <h1>Visionneuse de fichiers</h1>
  <div id="content">Chargement...</div>

  <script>
    async function loadFile() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("n"); // ex: ?n=1

      if (!id) {
        document.getElementById("content").innerText = "Veuillez indiquer un ID avec ?n=...";
        return;
      }

      try {
        // Charger la liste des fichiers
        const res = await fetch("scripts.json");
        const data = await res.json();

        if (!(id in data)) {
          document.getElementById("content").innerText = "Fichier introuvable pour l’ID " + id;
          return;
        }

        const fileName = data[id];

        // Si c'est un PDF → on l'intègre avec <embed>
        if (fileName.endsWith(".pdf")) {
          document.getElementById("content").innerHTML = `
            <h2>${fileName}</h2>
            <embed src="${fileName}" type="application/pdf" width="100%" height="600px" />
          `;
        } 
        // Sinon → on affiche comme du texte (pour .py par ex.)
        else {
          const fileRes = await fetch(fileName);
          const code = await fileRes.text();
          document.getElementById("content").innerHTML = `<h2>${fileName}</h2><pre>${code}</pre>`;
        }
      } catch (err) {
        document.getElementById("content").innerText = "Erreur de chargement : " + err;
      }
    }

    loadFile();
  </script>
</body>
</html>
